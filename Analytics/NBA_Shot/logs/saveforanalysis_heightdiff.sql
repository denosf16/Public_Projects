SELECT 
    s.SHOT_EVENT_ID,
    s.PLAYER_ID,
	s.PLAYER_NAME,
    s.CLOSEST_DEFENDER_PLAYER_ID,
	s.CLOSEST_DEFENDER,
	s.GAME_ID,
	s.TIME_REMAINING,
	s.OT,
	s.SHOT_MADE,
	s.PTS_TYPE,
	s.SHOT_DIST,
	s.CLOSE_DEF_DIST
	s.TOUCH_TIME,
	s.DRIBBLES,
	s.SHOT_CLOCK,
    p1.HEIGHT_INCHES AS SHOOTER_HEIGHT,
    p2.HEIGHT_INCHES AS DEFENDER_HEIGHT,
    (p1.HEIGHT_INCHES - p2.HEIGHT_INCHES) AS HEIGHT_DIFFERENTIAL
FROM 
    player_shot_logs s
LEFT JOIN 
    player_info_analysis p1 ON s.PLAYER_ID = p1.PLAYER_ID
LEFT JOIN 
    player_info_analysis p2 ON s.CLOSEST_DEFENDER_PLAYER_ID = p2.PLAYER_ID
WHERE 
    p1.HEIGHT_INCHES IS NOT NULL AND p2.HEIGHT_INCHES IS NOT NULL;

